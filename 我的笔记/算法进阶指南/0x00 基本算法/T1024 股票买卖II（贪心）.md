# T1024 股票买卖II

给定一个长度为 $N$ 的数组，数组中的第 $i$ 个数字表示一个给定股票在第 $i$ 天的价格。

设计一个算法来计算你所能获取的最大利润。你可以尽可能地完成更多的交易（多次买卖一支股票）。

注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。

#### 输入格式

第一行包含整数 $N$，表示数组长度。

第二行包含 $N$ 个不大于 $10000$ 的正整数，表示完整的数组。

#### 输出格式

输出一个整数，表示最大利润。

#### 数据范围

$1 \le N \le 10^5$

#### 输入样例1：

```
6
7 1 5 3 6 4
```

#### 输出样例1：

```
7
```

#### 输入样例2：

```
5
1 2 3 4 5
```

#### 输出样例2：

```
4
```

#### 输入样例3：

```
5
7 6 4 3 1
```

#### 输出样例3：

```
0
```

#### 样例解释

样例1：在第 2 天（股票价格 = 1）的时候买入，在第 3 天（股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。随后，在第 4 天（股票价格 = 3）的时候买入，在第 5 天（股票价格 = 6）的时候卖出, 这笔交易所能获得利润 = 6-3 = 3 。共得利润 4+3 = 7。

样例2：在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。

样例3：在这种情况下, 不进行任何交易, 所以最大利润为 0。

## 题解

动态规划 + 贪心转移优化。

考虑最基础的形式，设 $f(x)$ 表示到第 $x$ 天能拿到的最大收益，

考虑到这一天只有卖出才能得到其他的收益，因此枚举买入的时间，

记 $g(x)$ 表示第 $x$ 天卖出可以得到的最大收益，易得，

$$
g(x)=\max_{1\le i<x}\{f(i)+a(x)-a(i)\}
$$

同时，易知，

$$
f(x)=\max_{1\le i\le x}g(x)
$$

考虑到 $g(x)$ 的形式可以转换，假设 $x$ 是从 $i$ 转移过来的，

$$
g(x)=a(x)+[f(i)-a(i)]
$$

后面的东西显然没有限制的可以从前面取，因此实时记录后面的东西的最大值，

然后没了。代码，

```cpp
#include <bits/stdc++.h>

using namespace std;

#define endl '\n'

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int n; cin >> n;
    vector<int> a(n + 1), f(n + 1);
    for (int i = 1; i <= n; ++i) cin >> a[i];
	int ans = 0, lt = -a[1];
    for (int i = 1; i <= n; ++i) {
    	f[i] = max(f[i - 1], a[i] + lt);
    	lt = max(lt, f[i] - a[i]);
    }
    cout << f[n] << endl;
	return 0;
}
```

UPD：补充贪心思路。

一个经典结论：低买高卖。

没了，因此答案：

$$
\sum_{i=1}^{n-1}\max\{p_{i+1}-p_i,0\}
$$